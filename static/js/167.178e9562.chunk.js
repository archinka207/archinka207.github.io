"use strict";(self.webpackChunktwentythree=self.webpackChunktwentythree||[]).push([[167],{680:(e,a,s)=>{s.d(a,{D:()=>r});var t=s(2162);const r=async()=>{try{return(await t.A.get("/interests")).data}catch(a){var e;return console.error("Error fetching interests:",(null===(e=a.response)||void 0===e?void 0:e.data)||a.message),[]}}},1796:(e,a,s)=>{s.d(a,{CX:()=>d,HR:()=>c,Ij:()=>n,R7:()=>i,Tu:()=>r,Zm:()=>l,sS:()=>o});var t=s(2162);const r=async e=>{try{return(await t.A.post("/chats",e)).data}catch(s){var a;throw console.error("Error creating new chat:",(null===(a=s.response)||void 0===a?void 0:a.data)||s.message),s}},n=async e=>{try{return(await t.A.post("/chats/join/".concat(e))).data}catch(s){var a;throw console.error("Error joining chat for interest ID ".concat(e,":"),(null===(a=s.response)||void 0===a?void 0:a.data)||s.message),s}},o=async()=>{try{return(await t.A.get("/chats/current")).data}catch(a){var e;if(a.response&&(404===a.response.status||204===a.response.status))return null;throw console.error("Error fetching current chat:",(null===(e=a.response)||void 0===e?void 0:e.data)||a.message),a}},c=async e=>{try{return(await t.A.get("/chats/".concat(e))).data}catch(s){var a;throw console.error("Error fetching details for chat ID ".concat(e,":"),(null===(a=s.response)||void 0===a?void 0:a.data)||s.message),s}},l=async e=>{try{return(await t.A.get("/chats/".concat(e,"/messages"))).data}catch(s){var a;return console.warn("Failed to fetch initial messages for chat ".concat(e," via HTTP. This endpoint might not be implemented on the backend. Chat will rely on WebSocket for new messages."),(null===(a=s.response)||void 0===a?void 0:a.data)||s.message),[]}},i=async(e,a)=>{const s=new FormData;s.append("file",a);try{return(await t.A.post("/chats/".concat(e,"/messages/image"),s,{})).data}catch(n){var r;throw console.error("Error uploading image for chat ".concat(e,":"),(null===(r=n.response)||void 0===r?void 0:r.data)||n.message),n}},d=async e=>{try{return(await t.A.post("/chats/".concat(e,"/leave"))).data}catch(s){var a;throw console.error("Error leaving chat ".concat(e,":"),(null===(a=s.response)||void 0===a?void 0:a.data)||s.message),s}}},5094:(e,a,s)=>{s.d(a,{A:()=>n});s(5043);var t=s(1719),r=s(579);const n=e=>{let{variant:a="danger",message:s,show:n=!0,onClose:o,className:c="mt-3"}=e;if(!n||!s)return null;let l=s;if("object"===typeof s&&null!==s)if(s.response&&s.response.data)l="string"===typeof s.response.data.message?s.response.data.message:"string"===typeof s.response.data?s.response.data:s.response.data.errors?Object.values(s.response.data.errors).join(". "):"An unexpected error occurred. Please check console.";else if(s.message)l=s.message;else try{l=JSON.stringify(s)}catch(i){l="An unreadable error object was received."}return(0,r.jsx)(t.A,{variant:a,onClose:o,dismissible:!!o,className:c,role:"alert",children:l})}},7167:(e,a,s)=>{s.r(a),s.d(a,{default:()=>le});var t,r=s(5043),n=s(3260),o=s(342),c=s(7417),l=s(3519),i=s(1072),d=s(8602),u=s(8628),h=s(3637),m=s(4282),x=s(45),g=s(2555),p=s(8139),b=s.n(p),f=s(3043),v=s(8279),A=s(182),y=s(8260);function j(e){if((!t&&0!==t||e)&&v.A){var a=document.createElement("div");a.style.position="absolute",a.style.top="-9999px",a.style.width="50px",a.style.height="50px",a.style.overflow="scroll",document.body.appendChild(a),t=a.offsetWidth-a.clientWidth,document.body.removeChild(a)}return t}var N=s(6618),w=s(8293);function C(e){const a=function(e){const a=(0,r.useRef)(e);return a.current=e,a}(e);(0,r.useEffect)((()=>()=>a.current()),[])}var E=s(4232),k=s(3655),S=s(5675),F=s(8072),T=s(7852),P=s(579);const R=["className","bsPrefix","as"],D=r.forwardRef(((e,a)=>{let{className:s,bsPrefix:t,as:r="div"}=e,n=(0,x.A)(e,R);return t=(0,T.oU)(t,"modal-body"),(0,P.jsx)(r,(0,g.A)({ref:a,className:b()(s,t)},n))}));D.displayName="ModalBody";const I=D;var z=s(1602);const H=["bsPrefix","className","contentClassName","centered","size","fullscreen","children","scrollable"],B=r.forwardRef(((e,a)=>{let{bsPrefix:s,className:t,contentClassName:r,centered:n,size:o,fullscreen:c,children:l,scrollable:i}=e,d=(0,x.A)(e,H);s=(0,T.oU)(s,"modal");const u="".concat(s,"-dialog"),h="string"===typeof c?"".concat(s,"-fullscreen-").concat(c):"".concat(s,"-fullscreen");return(0,P.jsx)("div",(0,g.A)((0,g.A)({},d),{},{ref:a,className:b()(u,t,o&&"".concat(s,"-").concat(o),n&&"".concat(u,"-centered"),i&&"".concat(u,"-scrollable"),c&&h),children:(0,P.jsx)("div",{className:b()("".concat(s,"-content"),r),children:l})}))}));B.displayName="ModalDialog";const L=B,O=["className","bsPrefix","as"],U=r.forwardRef(((e,a)=>{let{className:s,bsPrefix:t,as:r="div"}=e,n=(0,x.A)(e,O);return t=(0,T.oU)(t,"modal-footer"),(0,P.jsx)(r,(0,g.A)({ref:a,className:b()(s,t)},n))}));U.displayName="ModalFooter";const M=U;var _=s(2258);const W=["bsPrefix","className","closeLabel","closeButton"],J=r.forwardRef(((e,a)=>{let{bsPrefix:s,className:t,closeLabel:r="Close",closeButton:n=!1}=e,o=(0,x.A)(e,W);return s=(0,T.oU)(s,"modal-header"),(0,P.jsx)(_.A,(0,g.A)((0,g.A)({ref:a},o),{},{className:b()(t,s),closeLabel:r,closeButton:n}))}));J.displayName="ModalHeader";const K=J;var G=s(4488);const q=["className","bsPrefix","as"],Z=(0,G.A)("h4"),X=r.forwardRef(((e,a)=>{let{className:s,bsPrefix:t,as:r=Z}=e,n=(0,x.A)(e,q);return t=(0,T.oU)(t,"modal-title"),(0,P.jsx)(r,(0,g.A)({ref:a,className:b()(s,t)},n))}));X.displayName="ModalTitle";const Y=X,Q=["bsPrefix","className","style","dialogClassName","contentClassName","children","dialogAs","data-bs-theme","aria-labelledby","aria-describedby","aria-label","show","animation","backdrop","keyboard","onEscapeKeyDown","onShow","onHide","container","autoFocus","enforceFocus","restoreFocus","restoreFocusOptions","onEntered","onExit","onExiting","onEnter","onEntering","onExited","backdropClassName","manager"];function V(e){return(0,P.jsx)(F.A,(0,g.A)((0,g.A)({},e),{},{timeout:null}))}function $(e){return(0,P.jsx)(F.A,(0,g.A)((0,g.A)({},e),{},{timeout:null}))}const ee=r.forwardRef(((e,a)=>{let{bsPrefix:s,className:t,style:n,dialogClassName:o,contentClassName:c,children:l,dialogAs:i=L,"data-bs-theme":d,"aria-labelledby":u,"aria-describedby":h,"aria-label":m,show:p=!1,animation:F=!0,backdrop:R=!0,keyboard:D=!0,onEscapeKeyDown:I,onShow:H,onHide:B,container:O,autoFocus:U=!0,enforceFocus:M=!0,restoreFocus:_=!0,restoreFocusOptions:W,onEntered:J,onExit:K,onExiting:G,onEnter:q,onEntering:Z,onExited:X,backdropClassName:Y,manager:ee}=e,ae=(0,x.A)(e,Q);const[se,te]=(0,r.useState)({}),[re,ne]=(0,r.useState)(!1),oe=(0,r.useRef)(!1),ce=(0,r.useRef)(!1),le=(0,r.useRef)(null),[ie,de]=(0,r.useState)(null),ue=(0,w.A)(a,de),he=(0,N.A)(B),me=(0,T.Wz)();s=(0,T.oU)(s,"modal");const xe=(0,r.useMemo)((()=>({onHide:he})),[he]);function ge(){return ee||(0,S.R)({isRTL:me})}function pe(e){if(!v.A)return;const a=ge().getScrollbarWidth()>0,s=e.scrollHeight>(0,A.A)(e).documentElement.clientHeight;te({paddingRight:a&&!s?j():void 0,paddingLeft:!a&&s?j():void 0})}const be=(0,N.A)((()=>{ie&&pe(ie.dialog)}));C((()=>{(0,y.A)(window,"resize",be),null==le.current||le.current()}));const fe=()=>{oe.current=!0},ve=e=>{oe.current&&ie&&e.target===ie.dialog&&(ce.current=!0),oe.current=!1},Ae=()=>{ne(!0),le.current=(0,E.A)(ie.dialog,(()=>{ne(!1)}))},ye=e=>{"static"!==R?ce.current||e.target!==e.currentTarget?ce.current=!1:null==B||B():(e=>{e.target===e.currentTarget&&Ae()})(e)},je=(0,r.useCallback)((e=>(0,P.jsx)("div",(0,g.A)((0,g.A)({},e),{},{className:b()("".concat(s,"-backdrop"),Y,!F&&"show")}))),[F,Y,s]),Ne=(0,g.A)((0,g.A)({},n),se);Ne.display="block";return(0,P.jsx)(z.A.Provider,{value:xe,children:(0,P.jsx)(k.A,{show:p,ref:ue,backdrop:R,container:O,keyboard:!0,autoFocus:U,enforceFocus:M,restoreFocus:_,restoreFocusOptions:W,onEscapeKeyDown:e=>{D?null==I||I(e):(e.preventDefault(),"static"===R&&Ae())},onShow:H,onHide:B,onEnter:(e,a)=>{e&&pe(e),null==q||q(e,a)},onEntering:(e,a)=>{null==Z||Z(e,a),(0,f.Ay)(window,"resize",be)},onEntered:J,onExit:e=>{null==le.current||le.current(),null==K||K(e)},onExiting:G,onExited:e=>{e&&(e.style.display=""),null==X||X(e),(0,y.A)(window,"resize",be)},manager:ge(),transition:F?V:void 0,backdropTransition:F?$:void 0,renderBackdrop:je,renderDialog:e=>(0,P.jsx)("div",(0,g.A)((0,g.A)({role:"dialog"},e),{},{style:Ne,className:b()(t,s,re&&"".concat(s,"-static"),!F&&"show"),onClick:R?ye:void 0,onMouseUp:ve,"data-bs-theme":d,"aria-label":m,"aria-labelledby":u,"aria-describedby":h,children:(0,P.jsx)(i,(0,g.A)((0,g.A)({},ae),{},{onMouseDown:fe,className:o,contentClassName:c,children:l}))}))})})}));ee.displayName="Modal";const ae=Object.assign(ee,{Body:I,Header:K,Title:Y,Footer:M,Dialog:L,TRANSITION_DURATION:300,BACKDROP_TRANSITION_DURATION:150});var se=s(5460),te=s(680),re=s(1796),ne=s(5094),oe=s(4648),ce=s(353);const le=()=>{const{currentUser:e,loading:a}=(0,o.A)(),s=(0,n.Zp)(),[t,x]=(0,r.useState)([]),[g,p]=(0,r.useState)(""),[b,f]=(0,r.useState)(!1),[v,A]=(0,r.useState)(!1),[y,j]=(0,r.useState)(""),[N,w]=(0,r.useState)(""),[C,E]=(0,r.useState)(""),[k,S]=(0,r.useState)(""),[F,T]=(0,r.useState)(!1),[R,D]=(0,r.useState)(!1);(0,r.useEffect)((()=>{if(e&&!a){(async()=>{try{const e=await(0,re.sS)();e&&e.id&&s("/chat",{replace:!0})}catch(e){!e.response||404!==e.response.status&&204!==e.response.status?console.error("Error checking for active chat:",e):console.log("No active chat found for current user.")}})()}}),[e,a,s]);const I=(0,r.useCallback)((async()=>{D(!0),E("");try{const e=await(0,te.D)();x(e||[]),e&&e.length>0&&(p(e[0].id.toString()),w(e[0].id.toString()))}catch(s){var e,a;console.error("Failed to fetch interests:",s),E((null===(e=s.response)||void 0===e||null===(a=e.data)||void 0===a?void 0:a.message)||"Failed to load interests. Please try again.")}finally{D(!1)}}),[]);(0,r.useEffect)((()=>{I()}),[I]);return a?(0,P.jsx)("div",{className:"text-center mt-5",children:(0,P.jsx)(c.A,{animation:"border",role:"status",children:(0,P.jsx)("span",{className:"visually-hidden",children:"Loading user data..."})})}):(0,P.jsxs)(l.A,{className:"mt-4",children:[(0,P.jsx)(i.A,{className:"justify-content-center text-center mb-5",children:(0,P.jsx)(d.A,{md:8,children:(0,P.jsx)(u.A,{className:"p-4 shadow-sm",children:(0,P.jsxs)(u.A.Body,{children:[(0,P.jsx)(u.A.Title,{as:"h1",children:"Welcome to TwentyThree!"}),(0,P.jsx)(u.A.Text,{className:"lead",children:"Discover temporary group chats based on your interests. Connect, discuss, and explore with like-minded individuals in an anonymous and spontaneous environment."})]})})})}),(0,P.jsx)(ne.A,{message:C,show:!!C,variant:"danger"}),e?(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(i.A,{className:"justify-content-center align-items-center mb-4 text-center",children:(0,P.jsx)(d.A,{xs:"auto",children:(0,P.jsxs)(n.N_,{to:"/profile",className:"text-decoration-none text-dark d-flex flex-column align-items-center",children:[(0,P.jsx)(h.A,{src:(0,ce.m_)(e.profilePictureUrl)||oe,alt:e.nickname,roundedCircle:!0,style:{width:"60px",height:"60px",objectFit:"cover",border:"2px solid #007bff"},onError:e=>{e.target.onerror=null,e.target.src=oe}}),(0,P.jsx)("span",{className:"mt-2 fw-bold",children:e.nickname})]})})}),(0,P.jsxs)(i.A,{className:"justify-content-center text-center",children:[(0,P.jsx)(d.A,{md:5,lg:4,className:"mb-3",children:(0,P.jsx)(m.A,{variant:"outline-primary",size:"lg",className:"w-100 py-3",onClick:()=>{S(""),j(""),A(!0)},disabled:F||R,children:F||R?(0,P.jsx)(c.A,{as:"span",size:"sm",animation:"border"}):"Make New Chat"})}),(0,P.jsx)(d.A,{md:5,lg:4,className:"mb-3",children:(0,P.jsx)(m.A,{variant:"outline-success",size:"lg",className:"w-100 py-3",onClick:()=>{S(""),f(!0)},disabled:F||R,children:F||R?(0,P.jsx)(c.A,{as:"span",size:"sm",animation:"border"}):"Join Existing Chat"})})]})]}):(0,P.jsx)(i.A,{className:"justify-content-center text-center",children:(0,P.jsx)(d.A,{md:6,children:(0,P.jsxs)(u.A,{className:"p-3 shadow-sm",children:[(0,P.jsx)("p",{className:"mb-2",children:"Please login or register to start chatting."}),(0,P.jsx)(n.N_,{to:"/login",className:"btn btn-primary btn-lg me-2",children:"Login"}),(0,P.jsx)(n.N_,{to:"/register",className:"btn btn-secondary btn-lg",children:"Register"})]})})}),(0,P.jsxs)(ae,{show:b,onHide:()=>f(!1),centered:!0,children:[(0,P.jsx)(ae.Header,{closeButton:!0,children:(0,P.jsx)(ae.Title,{children:"Join Chat by Interest"})}),(0,P.jsxs)(se.A,{onSubmit:async e=>{if(e.preventDefault(),g){T(!0),S("");try{await(0,re.Ij)(g),s("/chat")}catch(r){var a,t;console.error("Failed to join chat:",r),S((null===(a=r.response)||void 0===a||null===(t=a.data)||void 0===t?void 0:t.message)||"Failed to join chat. No active chats for this interest or you might already be in one.")}finally{T(!1)}}else S("Please select an interest to join a chat.")},children:[(0,P.jsxs)(ae.Body,{children:[(0,P.jsx)(ne.A,{message:k,show:!!k,variant:"danger"}),(0,P.jsxs)(se.A.Group,{className:"mb-3",children:[(0,P.jsx)(se.A.Label,{children:"Select an Interest"}),R?(0,P.jsxs)("div",{className:"text-center",children:[(0,P.jsx)(c.A,{animation:"border",size:"sm"})," Loading interests..."]}):t.length>0?(0,P.jsx)(se.A.Select,{value:g,onChange:e=>p(e.target.value),disabled:F,required:!0,children:t.map((e=>(0,P.jsx)("option",{value:e.id,children:e.name},e.id)))}):(0,P.jsx)("p",{className:"text-muted",children:"No interests available."})]})]}),(0,P.jsxs)(ae.Footer,{children:[(0,P.jsx)(m.A,{variant:"outline-secondary",onClick:()=>f(!1),disabled:F,children:"Cancel"}),(0,P.jsx)(m.A,{variant:"success",type:"submit",disabled:F||R||!g,children:F?(0,P.jsx)(c.A,{as:"span",size:"sm",animation:"border"}):"Join Chat"})]})]})]}),(0,P.jsxs)(ae,{show:v,onHide:()=>A(!1),centered:!0,children:[(0,P.jsx)(ae.Header,{closeButton:!0,children:(0,P.jsx)(ae.Title,{children:"Create a New Chat"})}),(0,P.jsxs)(se.A,{onSubmit:async e=>{if(e.preventDefault(),N){T(!0),S("");try{await(0,re.Tu)({chatName:y.trim()||null,primaryInterestId:parseInt(N)}),s("/chat")}catch(r){var a,t;console.error("Failed to create chat:",r),S((null===(a=r.response)||void 0===a||null===(t=a.data)||void 0===t?void 0:t.message)||"Failed to create chat. You might already have an active chat.")}finally{T(!1)}}else S("Please select an interest for the new chat.")},children:[(0,P.jsxs)(ae.Body,{children:[(0,P.jsx)(ne.A,{message:k,show:!!k,variant:"danger"}),(0,P.jsxs)(se.A.Group,{className:"mb-3",children:[(0,P.jsx)(se.A.Label,{children:"Chat Name (Optional)"}),(0,P.jsx)(se.A.Control,{type:"text",placeholder:"E.g., Sci-Fi Book Club",value:y,onChange:e=>j(e.target.value),disabled:F})]}),(0,P.jsxs)(se.A.Group,{className:"mb-3",children:[(0,P.jsx)(se.A.Label,{children:"Primary Interest"}),R?(0,P.jsxs)("div",{className:"text-center",children:[(0,P.jsx)(c.A,{animation:"border",size:"sm"})," Loading interests..."]}):t.length>0?(0,P.jsx)(se.A.Select,{value:N,onChange:e=>w(e.target.value),required:!0,disabled:F,children:t.map((e=>(0,P.jsx)("option",{value:e.id,children:e.name},e.id)))}):(0,P.jsx)("p",{className:"text-muted",children:"No interests available to create a chat."})]})]}),(0,P.jsxs)(ae.Footer,{children:[(0,P.jsx)(m.A,{variant:"outline-secondary",onClick:()=>A(!1),disabled:F,children:"Cancel"}),(0,P.jsx)(m.A,{variant:"primary",type:"submit",disabled:F||R||!N,children:F?(0,P.jsx)(c.A,{as:"span",size:"sm",animation:"border"}):"Create Chat"})]})]})]})]})}}}]);
//# sourceMappingURL=167.178e9562.chunk.js.map